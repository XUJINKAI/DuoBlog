{% extends './base.html' %}

{% block title %}Create Page{% endblock %}


{% block css %}
<link href="//cdn.bootcss.com/wangeditor/2.1.20/css/wangEditor.min.css" rel="stylesheet">
<style>
#page_content_div {
	width: 100%;
	min-height: 350px;
}
</style>
{% endblock %}


{% block content %}
<div class="row">
	<div id="page_edit_form">
		{% csrf_token %}
		<div class="form-group">
			<div class="form-check">
    			<label for="sites">Sites </label>
    			{% for blog in blogs %}
				<label class="form-check-label">
					<input class="form-check-input" type="checkbox" name="blog" value="{{ blog.pk }}"> {{ blog.name }}
				</label>
				{% endfor %}
			</div>
    	</div>
		<div class="form-group form-inline">
			<label class="" for="inlineFormCustomSelect">URL </label>
			<select class="form-control" name="url_prefix">
				<option value="pages">/pages/</option>
				<option value="about">/about/</option>
			</select>
			<input type="input" class="form-control">
		</div>
		<div class="form-group">
			<label class="mr-sm-2" for="inlineFormCustomSelect">Title</label>
			<input type="input" class="form-control" name="title">
		</div>
		<div class="form-group">
			<label class="mr-sm-2" for="inlineFormCustomSelect">Content</label>
			<div id="page_content_div" name="content"></div>
		</div>
		<div class="form-check">
			<label class="form-check-label">
				<input type="checkbox" class="form-check-input" name="comments" v-bind:checked="comments"> Comments
			</label>
		</div>
		<a class="btn btn-primary" href="javascript:void(0);" onclick="save_page();">Save</a>
	</div>
</div>
{% endblock %}


{% block js %}
<script src="//cdn.bootcss.com/wangeditor/2.1.20/js/wangEditor.min.js"></script>
<script>
var page_create_app = new Vue({
	delimiters: ['${', '}'],
	el: '#page_edit_form',
	data: {
		blogs: [],
		url_prefix: '',
		url: '',
		title: '',
		content: '',
		comments: true,
	}
});
//
var html_editor = null;
var edit_post = function(){
	if(html_editor) return;
	html_editor = new wangEditor('page_content_div');
	html_editor.config.jsFilter = false;
	html_editor.config.uploadImgUrl = '/api/img/';
	html_editor.config.uploadHeaders = {
		'X-CSRFToken': getCookie('csrftoken'),
	};
	html_editor.config.uploadImgFileName = 'file'
	html_editor.onchange = function(){
		page_create_app.content = html_editor.$txt.html()
	};
	html_editor.create();
};
var save_page = function() {
	var data = {
		// 'sites': 
	}
	console.log(data);
	// $.ajax({

	// })
}
//
edit_post();
</script>
{% endblock %}